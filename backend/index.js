const express = require('express'); const app = express(); const { PrismaClient } = require('@prisma/client'); const prisma = new PrismaClient(); const jwt = require('jsonwebtoken'); const bcrypt = require('bcrypt'); require('dotenv').config(); app.use(express.json()); app.use(express.urlencoded({ extended: true })); app.use(express.static('public')); const authenticate = async (req, res, next) => { const token = req.header('Authorization'); if (!token) return res.status(401).send('Access denied. No token provided.'); try { const decoded = jwt.verify(token, process.env.SECRET_KEY); req.user = decoded; next(); } catch (ex) { res.status(400).send('Invalid token.'); } };